
**==`func authUser:`==**

`tcsUserProfile := client.GetProfileV4` ==<-- использую DisplayName, Avatar и UserID==
`localUserInfo := c.Database.CreateOrUpdateUser`
`
`rights := c.getUserRightsByDomain`

Создаю **accessToken** и **refreshToken**, куда зашиваю в том числе rights

`c.Database.AuthUser  <-- пишем инфу о токене в БД в таблицу "token":` 
* `tcsUserProfile.User.DisplayName`
* `tcsUserProfile.User.Avatar`
* `localUserInfo.Id`
* `AccessToken: accessTokenId` ==<-- это не сам токен, а его ID==
* `RefreshToken: refreshTokenId` ==<-- тоже ID==

`c.downloadOrUpdateUserAvatar` ==<-- работа с БД (запись) и ФС==

`return accessToken и refreshToken`


Вопрос:
* Я записал права в токен, а в таблицу "token" пишу на самом деле только id токенов. Задача же - добавить в таблицу token помимо id токена ещё и сами права? Если так, то зачем тогда права сохранять в самом токене, если я на месте их сохраняю в БД - ведь это дублирование? Если оставить дублирование, то на основании чего мне права проверять - раскрывать JWT и читать права или смотреть на те, что лежат в БД по id токена? Но я же его раскрываю для того, чтобы удостовериться в id - тогда и вижу права сразу - зачем в БД лезть за ними? Если не за чем, то зачем их в БД хранить всё-таки?