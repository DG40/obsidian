
**Логгирование в системе лицензирования**

- [ ] Нужно добавить недостающие проверки, а именно:
1) Проверить информацию о hw-хэше, который в сертификате зашит, и о том, который сгенерирован с текущего окружения. Если не совпадают - это тоже отдельное событие о том, что сертификат выдан на другое железоИ дальше третья проверка, её на самом деле можно выполнять первой. Это проверить информацию о hw-хэше, который в сертификате зашит, и о том, который сгенерирован с текущего окружения. Если не совпадают - это тоже отдельное событие о том, что сертификат выдан на другое железо
2) .. корневым сертификатом (не как продакшеном), и вот комбинировать на инсталляции, например зарегать на одном, например на проде, и подменить лицензии с беттой. И у них уже должна быть проверка и ошибка в логах о том, что лицензия подписана не доверенным сертификатом (не моим)
3) Второй момент - вот мы проверили лицензии, выданные регом, но они могут быть выданы регом для другого продукта (другой инсталляции). Поэтому вторая проверка - в каждой лицензии есть id продукта, и нужно проверить, что ID продукта соответствует ID продукта в сертификате (авторизационному). Если не совпадают, то тоже ошибка, запись в лог эвента, что лицензии не соответствуют сертификату

Далее, если эти 3 проверки как минимум пройдены, то только после этого можно приступить к суммированию параметров действующей лицензии, чтобы сгенерировать суммарный конфиг и об этом тоже швырнуть ивент, что конфиг такой-то
Если подкинули невалидные лицензии, то это мягко должно проходить с обновлением списка лицензий, просто в логах будет отмечено, что подложенная лицензия удалена (сейчас этого нет, но должно быть, это нужно обсудить с Андреем Шкуновым). А вот если другие ошибки (выше), то продукт переходит в состояние "не зарегистрирован"

- [x] Нужно прокинуть в логи вообще все события, приходящие в канал ивентов библиотеки tclicense

Проследил порядок работы механизма обновления файлов лицензии:
- run (из core)
	- start
		- runLicenseService (тут переходим в tclicense к RunValidationWorker)
			- RunValidationWorker (из tclicense)
				- RefreshLicenseInfo
					- DownloadLicenses
						- ReplaceLicenses (в файле fs.go)
В "ReplaceLicenses" код такой: подаётся список лицензий с CRM, удаляется всё из папки с постфиксом backup, base переименовывается в backup, создаётся папка c постфиксом tmp, в неё пишутся файлы по поданному списку лицензий, после чего папка с постфиксом tmp переименовывается в base. Если где-то ранее была ошибка, то далее папка с постфиксом backup переименовывается в base, а папка с постфиксом tmp удаляется

- [ ]  Корневой сертификат (ca.crt) должен быть зашит в продукт
